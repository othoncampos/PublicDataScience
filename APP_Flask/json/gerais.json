{
  "selects":{
    "QuantidadeParlamentares": "SELECT valor FROM siconvminerado.dados_gerais where  parametro =  'qtd_parlamentares'",  
    "QuantidadeConvenios":"SELECT valor FROM siconvminerado.dados_gerais where  parametro =  'qtd_convenios'",
    "QuantidadeEmpresas": "SELECT valor FROM siconvminerado.dados_gerais where  parametro =  'qtd_empresas'",
    "JSONQuantidadesParConEmp" : "SELECT json_object(parametro, valor) FROM siconvminerado.dados_gerais",
    "ValoresEstado" : "SELECT ano , sum(qtd_proposta) as qtd_proposta, sum(qtd_convenio) as qtd_convenio, sum(vl_total_proposta) as vl_total_proposta, sum(vl_total_convenio) as vl_total_convenio, sum(vl_total_contrapartida_conv) as vl_total_contrapartida_conv FROM siconvminerado.numero_total where uf = '%s' group by ano order by ano",
    "QuantConvPorMes" : "SELECT nt.ano, nt.mes, sum(qtd_proposta) as qtd_proposta, ( SELECT  ROUND(avg(qtd_proposta)) FROM siconvminerado.numero_total where mes = nt.mes and ano = nt.ano group by ano, mes) as avg_proposta, sum(qtd_convenio) as qtd_convenio, ( SELECT ROUND(avg(qtd_convenio)) FROM siconvminerado.numero_total where mes = nt.mes and ano = nt.ano group by ano, mes) as avg_convenio, sum(vl_total_proposta) as vl_total_proposta, sum(vl_total_convenio) as vl_total_convenio, sum(vl_total_contrapartida_conv) as vl_total_contrapartida_conv FROM siconvminerado.numero_total as nt where nt.uf = '%s' and nt.mes = '%s' group by nt.ano, nt.mes order by  nt.ano",
    "QuantConvMensal" : "SELECT mes, ano, sum(qtd_convenio) as qtd_convenio FROM siconvminerado.numero_total as nt where uf = '%s' group by ano, mes order by  mes, ano;",
    "QuantConvParlamentar_conv" : "SELECT nm_parlamentar, sum(qtd_convenio) as qtd_convenio, sum(vl_global_conv) as vl_global_conv FROM siconvminerado.paralamentares_total_convenio where uf = '%s' and tipo_parlamentar = 'INDIVIDUAL' group by nm_parlamentar order by 2 desc;",
    "QuantConvParlamentar_conv_top10" : "SELECT nm_parlamentar, sum(qtd_convenio) as qtd_convenio, sum(vl_global_conv) as vl_global_conv FROM siconvminerado.paralamentares_total_convenio where uf = '%s' and tipo_parlamentar = 'INDIVIDUAL' group by nm_parlamentar order by 2 desc limit 10;",
    "QuantConvParlamentar_valor" : "SELECT nm_parlamentar, sum(vl_global_conv) as vl_global_conv FROM siconvminerado.paralamentares_total_convenio where uf = '%s' and tipo_parlamentar = 'INDIVIDUAL' group by nm_parlamentar order by vl_global_conv desc;",
    "QuantConvParlamentar_valor_top10" : "SELECT nm_parlamentar, sum(vl_global_conv) as vl_global_conv FROM siconvminerado.paralamentares_total_convenio where uf = '%s' and tipo_parlamentar = 'INDIVIDUAL' group by nm_parlamentar order by vl_global_conv desc limit 10;",
    "ConvCidade_Qtd" : "SELECT cidade, count(*) as qtd FROM siconvminerado.situacao_convenio where uf = '%s' group by cidade order by 2 desc;",
    "ConvCidade_Valor" : "SELECT cidade, sum(vl_global_conv) as valor_total FROM siconvminerado.situacao_convenio where uf = '%s' group by cidade order by valor_total desc;",
    "conv_proponente" : "select pc.nm_proponente, count(*) as qtd, sum( c.vl_global_conv) as vl_global_conv from  siconv.siconv_convenio as c join siconv.siconv_proposta as pc on c.id_proposta = pc.id_proposta join siconv.siconv_emenda as ep on ep.id_proposta = pc.id_proposta where ep.tipo_parlamentar = 'INDIVIDUAL' and c.ano is not null and c.sit_convenio is not null and INSTRUMENTO_ATIVO not in ( 'NÃO', 'NAO', 'não', 'nao' ) and pc.uf_proponente = '%s' group by pc.nm_proponente order by 3 desc;",
    "SituacaoConvenio_Quant" : "SELECT sit_convenio, count(*) as qtd FROM siconvminerado.situacao_convenio where uf = '%s' group by sit_convenio order by qtd desc;",
    "DistribuicaoArea_Quant" : "SELECT area, count(*) as qtd FROM siconvminerado.situacao_convenio where uf = '%s' group by area order by qtd desc;",
    "DistribuicaoArea_Valor" : "SELECT area, sum(vl_global_conv) as valor_total FROM siconvminerado.situacao_convenio where uf = '%s' group by area order by valor_total desc;",
    "Outlier_estado" : "SELECT ano, vl_global_conv FROM siconvminerado.valores_convenio where upper( uf ) = upper( '%s' )  and sit_convenio not in ( 'Convênio Anulado' ) order by ano;",
    "RegrasAssociacaoUF" : "SELECT re.cd_regra, re.lhs, re.rhs, round(re.support * 100, 1) as support, round(re.confidence * 100, 1) as confidence, re.lift, re.count, re.phi, re.x2, case when truncate( (100 - (re.p * 100) ), 2 ) = 100 then 99.99 else truncate( (100 - (re.p * 100) ), 2 ) end as p, re.uf, re.cd_regra, r.nm_regra, round( re.count / re.support, 0 ) as Qtd_Conv FROM siconvminerado.regra_encontrada as re join siconvminerado.regra as r on re.cd_regra = r.cd_regra where r.st_ativa = 1 and confidence >= %s and support >= %s and truncate( (100 - (re.p * 100) ), 2 ) > %s and re.uf = '%s' order by p desc;",
    "EmpresasFaturamentoUF" : "select pv.nome_fornecedor, COUNT(*) as qtd_faturas, sum( vl_pago ) as vl_recebido from siconv.siconv_pagamento as pv where pv.nr_convenio in ( select distinct(c.nr_convenio) from siconv.siconv_convenio as c join siconv.siconv_proposta as p on p.id_proposta = c.id_proposta where p.uf_proponente = '%s' ) and nome_fornecedor != '' group by pv.nome_fornecedor order by 3 desc limit %s",
    "QuantidadeConveniosAtivosPorEstado" : "select pc.uf_proponente, count(*) from  siconv.siconv_convenio as c join siconv.siconv_proposta as pc on c.id_proposta = pc.id_proposta join siconv.siconv_emenda as ep on ep.id_proposta = pc.id_proposta where ep.tipo_parlamentar = 'INDIVIDUAL' and c.ano is not null and c.sit_convenio is not null and INSTRUMENTO_ATIVO not in ( 'NÃO', 'NAO', 'não', 'nao' ) group by pc.uf_proponente",
    "SQL_ToolTip" : "select * from siconvminerado.tooltip",
    "Nome_estado" : "select Descricao from siconv.estado where uf = '%s'"
  }
}